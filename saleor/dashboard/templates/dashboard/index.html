{% extends "dashboard/base.html" %}
{% load i18n %}
{% load prices_i18n %}

{% block title %}{{ block.super }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col s12">
        <div class="card">
            <div class="data-table-header{% if not preauthorized_payments %} data-table-header--no-data{% endif %}">
                <span class="card-title black-text">{% trans "Preauthorized payments" %}</span>
            </div>

            {% if preauthorized_payments %}
                <div class="data-table-container">
                    <table data-table-api="/dashboard/api/payments/"
                                        data-default-sort-column="id"
                                        data-default-sort="desc"
                                        data-max-page="{{ paginator.num_pages }}"
                                        data-no-data-message="{% trans "No payments found." %}"
                                        data-page-size="5"
                                        class="bordered hoverable responsive data-table data-table--orderable">
                        <thead>
                            <th data-key="id" data-component="CommonLink">{% trans "ID" %}</th>
                            <th data-key="created" data-component="CommonDate">{% trans "Date" %}</th>
                            <th data-key="variant" data-component="PaymentGateway">{% trans "Payment" %}</th>
                            <th data-key="total_price" data-css-class="right-align" data-component="CommonTotal">{% trans "Total" %}</th>
                            <th data-key="status" data-component="CommonStatus" data-css-class="wide">{% trans "Status" %}</th>
                        </thead>
                    </table>
                </div>
            {% else %}
                <div class="card-content card-content--no-data">
                    <p>{% trans "No preauthorized payments." %}</p>
                </div>
            {% endif %}
        </div>

        <div class="card">
            <div class="data-table-header{% if not orders_to_ship %} data-table-header--no-data{% endif %}">
                <span class="card-title black-text">{% trans "Orders ready for shipment" %}</span>
            </div>

            {% if orders_to_ship %}
                {% include "dashboard/includes/_orders_table.html" with orders=orders_to_ship page_size=5 %}
            {% else %}
                <div class="card-content card-content--no-data">
                    <p>{% trans "No orders are ready for shipment." %}</p>
                </div>
            {% endif %}
        </div>

        <div class="card">
            <div class="card-content">
                <span class="card-title black-text">{% trans "Products with low stock" %}</span>

                {% if low_stock %}
                    <ul class="list">
                        {% for product in low_stock %}
                            <li class="list-item">
                                <a class="list-item-name list-item-name--single" href="{% url "dashboard:product-update" pk=product.pk %}#stock">
                                    {{ product }} ({{ product.total_stock }})
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>{% trans "No products are low in stock." %}</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
